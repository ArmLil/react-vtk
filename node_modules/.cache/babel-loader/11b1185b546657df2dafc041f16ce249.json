{"ast":null,"code":"var _jsxFileName = \"/home/lilit/workspace/vtk/from_scratch_frontend_vtk/src/components/Product/ProductTable.js\",\n    _s = $RefreshSig$();\n\nimport * as React from \"react\"; // import \"./Roboto-Italic-italic.js\";\n// import \"./Roboto-Regular-italic.js\";\n\nimport \"./FiraSans-Regular-normal.js\";\nimport \"jspdf-autotable\";\nimport jsPDF from \"jspdf\";\nimport { XGrid } from \"@material-ui/x-grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { GridToolbarContainer, GridDensitySelector, GridFilterToolbarButton, GridColumnsToolbarButton } from \"@material-ui/x-grid\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport DeleteForeverOutlinedIcon from \"@material-ui/icons/DeleteForeverOutlined\";\nimport EditOutlinedIcon from \"@material-ui/icons/EditOutlined\";\nimport russian from \"../../constants/localeTextConstants.js\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport TextField from \"@material-ui/core/TextField\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport ProductAddDialog from \"./ProductAddDialog\";\nimport ProductUpdateDialog from \"./ProductUpdateDialog\";\nimport WorningDialog from \"../WorningDialog\";\nimport Button from \"@material-ui/core/Button\";\nimport { useSnackbar } from \"notistack\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles({\n  toolbarContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: 0.5\n  },\n  titleLevel: {\n    width: \"100%\",\n    paddingLeft: 20,\n    paddingRight: 20,\n    display: \"flex\",\n    justifyContent: \"center\"\n  },\n  buttonDownload: {\n    marginTop: 20\n  },\n  title: {\n    display: \"flex\",\n    flex: 1,\n    justifyContent: \"center\"\n  },\n  tableContainer: {\n    display: \"flex\",\n    height: \"85vh\",\n    width: \"100%\",\n    justifyContent: \"space-between\",\n    flexGrow: 1,\n    fontSize: \"18px\"\n  },\n  tools: {\n    width: \"100%\",\n    paddingLeft: 20,\n    paddingRight: 20,\n    marginBottom: 30,\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  iconButton: {\n    \"&:hover\": {\n      backgroundColor: \"#bdbdbd\"\n    },\n    margin: 0,\n    padding: 1\n  },\n  root: {\n    \"& .MuiDataGrid-columnsContainer\": {\n      backgroundColor: \"#e8eaf6\",\n      border: \"#bdbdbd solid 1px\"\n    },\n    \"& .MuiDataGrid-colCellTitle\": {\n      fontWeight: \"bold\"\n    }\n  }\n});\nexport default function ProductTable({\n  products,\n  deleteProduct,\n  addProduct,\n  updateProduct\n}) {\n  _s();\n\n  const [openAddDialog, setOpenAddDialog] = React.useState(false);\n  const [openUpdateDialog, setOpenUpdateDialog] = React.useState(false);\n  const [parameters, setParameters] = React.useState({});\n  const [namings, setNamings] = React.useState([]);\n  const [model, setModel] = React.useState({});\n  const [orientation, setOrientation] = React.useState(\"portrait\");\n  const [deleteDisabled, setDeleteDisabled] = React.useState(true);\n  const [selection, setSelection] = React.useState([]);\n  const [locations, setLocations] = React.useState([]);\n  const [employees, setEmployees] = React.useState([]);\n  const [openWorning, setOpenWorning] = React.useState(false);\n  const [openRowsWorning, setOpenRowsWorning] = React.useState(false);\n  const {\n    enqueueSnackbar\n  } = useSnackbar();\n  const classes = useStyles();\n  React.useEffect(() => {\n    const setItemsStates = async () => {\n      const resNamings = await fetch(\"http://localhost:3001/api/v1/namings\");\n      const dataNamings = await resNamings.json();\n      let namings_ = dataNamings.namings.rows.map(naming => {\n        return Object.assign({}, naming, {\n          name: `${naming.name} ${naming.decimalNumber}`\n        });\n      });\n      setNamings(namings_);\n      const resLocations = await fetch(\"http://localhost:3001/api/v1/locations\");\n      const dataLocations = await resLocations.json();\n      setLocations(dataLocations.locations.rows);\n      const resEmployees = await fetch(\"http://localhost:3001/api/v1/employees\");\n      const dataEmployees = await resEmployees.json();\n      let employees_ = dataEmployees.employees.rows.map(loc => {\n        return Object.assign({}, loc, {\n          name: `${loc.secondName} ${loc.name[0]}.${loc.fatherName[0]}.`\n        });\n      });\n      setEmployees(employees_);\n    };\n\n    setItemsStates();\n  }, []);\n\n  const handleAddDialogOpen = async () => {\n    setOpenAddDialog(true);\n  };\n\n  const handleUpdateDialogOpen = async params => {\n    let _params = Object.assign({}, params.row);\n\n    for (let param in _params) {\n      if (_params[param] === null) _params[param] = \"\";\n    }\n\n    setParameters(Object.assign({}, _params));\n    setOpenUpdateDialog(true);\n  };\n\n  const showNotification = text => {\n    enqueueSnackbar(text, {\n      variant: \"warning\",\n      anchorOrigin: {\n        vertical: \"top\",\n        horizontal: \"center\"\n      }\n    });\n  };\n\n  const handleCreate = (event, product) => {\n    console.log({\n      product\n    });\n    if (!product.namingId) showNotification(\"Необходимо выбрать Наименование.\");else if (!product.locationId) showNotification(\"Необходимо выбрать Место производства.\");else if (product.bookingDate && !product.bookingDate.match(/^(0?[1-9]|[12][0-9]|3[0-1])[/., -](0?[1-9]|1[0-2])[/., -](19|20)?\\d{2}$/)) {\n      showNotification(\"Неправильный фомат даты бронирования.\");\n    } else {\n      addProduct(product);\n      setOpenAddDialog(false);\n    }\n  };\n\n  const handleUpdate = (event, product) => {\n    if (product.bookingDate && !product.bookingDate.match(/^(0?[1-9]|[12][0-9]|3[0-1])[/., -](0?[1-9]|1[0-2])[/., -](19|20)?\\d{2}$/)) {\n      showNotification(\"Неправильный фомат даты бронирования.\");\n    } else {\n      updateProduct(product);\n      setOpenUpdateDialog(false);\n    }\n  };\n\n  const handleDeleteWorningClose = action => {\n    setOpenWorning(false);\n    if (action === \"submit\") deleteProduct(parameters);\n  };\n\n  const handleDeleteRowsWorningClose = action => {\n    setOpenRowsWorning(false);\n\n    if (action === \"submit\") {\n      console.log(\"submit\"); // deleteProduct(parameters);\n\n      selection.forEach((item, i) => {\n        console.log({\n          item\n        });\n        deleteProduct({\n          id: item\n        });\n      });\n    }\n  };\n\n  const handleDeleteWorningOpen = params => {\n    setOpenWorning(true);\n    setParameters(Object.assign({}, params.row));\n  };\n\n  const exportPDF = () => {\n    // console.log({ selection, model });\n    if (selection.length === 0) {\n      showNotification(\"Необходимо выбрать строки.\");\n      return;\n    }\n\n    let _columns = Object.entries(model.columns.lookup);\n\n    let _headers = [];\n\n    _columns.forEach((col, i) => {\n      if (col[1].hide === false && col[0] !== \"edit\" && col[0] !== \"delete\" && col[0] !== \"__check__\") {\n        if (col[0] === \"type\") {\n          _headers.push({\n            header: col[1].headerName,\n            dataKey: \"typeNumber\"\n          });\n        } else if (col[0] === \"location\") {\n          _headers.push({\n            header: col[1].headerName,\n            dataKey: \"locationNumber\"\n          });\n        } else {\n          _headers.push({\n            header: col[1].headerName,\n            dataKey: col[0]\n          });\n        }\n      }\n    });\n\n    console.log({\n      _headers\n    });\n    let expRows = [];\n\n    if (model.rows && Object.keys(model.rows.idRowsLookup).length > 0) {\n      selection.forEach((select, i) => {\n        expRows.push(model.rows.idRowsLookup[select]);\n      });\n    }\n\n    console.log({\n      expRows\n    });\n    const unit = \"pt\";\n    const size = \"A4\"; // Use A1, A2, A3 or A4\n\n    const _orientation = orientation; // portrait or landscape\n\n    const doc = new jsPDF(_orientation, unit, size);\n    doc.setFontSize(15);\n    doc.setFont(\"FiraSans-Regular\", \"normal\");\n    const title = \"ВТК - изделия\";\n    doc.setFillColor(0);\n    let content = {\n      startY: 70,\n      columns: _headers,\n      body: expRows,\n      styles: {\n        halign: \"center\",\n        font: \"FiraSans-Regular\",\n        lineColor: \"black\"\n      },\n      theme: \"grid\",\n      headStyles: {\n        halign: \"center\",\n        fillColor: \"#e8eaf6\",\n        textColor: \"black\",\n        lineWidth: 0.5\n      }\n    };\n    doc.text(title, 40, 40);\n    doc.autoTable(content);\n    console.log(window.location.href);\n    doc.save(\"report.pdf\");\n  };\n\n  const editColumn = {\n    field: \"edit\",\n    headerName: \"Редактировать\",\n    sortable: false,\n    flex: 0.2,\n    width: 135,\n    renderCell: params => /*#__PURE__*/_jsxDEV(IconButton, {\n      \"aria-label\": \"edit\",\n      color: \"primary\",\n      className: classes.iconButton,\n      onClick: () => {\n        handleUpdateDialogOpen(params);\n      },\n      children: /*#__PURE__*/_jsxDEV(EditOutlinedIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }, this)\n  };\n  const deleteColumn = {\n    field: \"delete\",\n    headerName: \"Удалить\",\n    sortable: false,\n    flex: 0.2,\n    renderCell: params => /*#__PURE__*/_jsxDEV(IconButton, {\n      \"aria-label\": \"delete\",\n      color: \"secondary\",\n      className: classes.iconButton,\n      onClick: () => handleDeleteWorningOpen(params),\n      children: /*#__PURE__*/_jsxDEV(DeleteForeverOutlinedIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 7\n    }, this)\n  };\n\n  if (products.columns && products.columns.length > 0) {\n    products.columns.push(editColumn);\n    products.columns.push(deleteColumn);\n  }\n\n  const columns = products.columns ? products.columns : [];\n  const rows = products.rows ? products.rows : [];\n\n  function CustomToolbar() {\n    return /*#__PURE__*/_jsxDEV(GridToolbarContainer, {\n      className: classes.toolbarContainer,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.titleLevel,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h5\",\n          gutterBottom: true,\n          className: classes.title,\n          children: \"\\u0418\\u0437\\u0434\\u0435\\u043B\\u0438\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.buttonDownload,\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            style: {\n              width: 110,\n              marginRight: 5\n            },\n            InputProps: {\n              style: {\n                fontSize: 14\n              }\n            },\n            id: \"filled-select-currency\",\n            select: true,\n            value: orientation,\n            onChange: ev => {\n              setOrientation(ev.target.value);\n            },\n            helperText: \"\\u041E\\u0440\\u0438\\u0435\\u043D\\u0442\\u0430\\u0446\\u0438\\u044F\",\n            children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"landscape\",\n              style: {\n                fontSize: 14\n              },\n              children: \"\\u0410\\u043B\\u044C\\u0431\\u043E\\u043C\\u043D\\u0430\\u044F\"\n            }, \"0\", false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: \"portrait\",\n              style: {\n                fontSize: 14\n              },\n              children: \"\\u041A\\u043D\\u0438\\u0436\\u043D\\u0430\\u044F\"\n            }, \"1\", false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            color: \"secondary\",\n            variant: \"outlined\",\n            onClick: () => exportPDF(),\n            children: [\" \", \"\\u0441\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.tools,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Tooltip, {\n            title: \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043D\\u043E\\u0432\\u044B\\u0439 \\u044D\\u043B\\u0435\\u043C\\u0435\\u043D\\u0442\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              size: \"small\",\n              variant: \"contained\",\n              color: \"primary\",\n              onClick: handleAddDialogOpen,\n              children: \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            color: \"secondary\",\n            size: \"small\",\n            style: {\n              marginLeft: 5\n            },\n            disabled: selection.length > 0 ? false : true,\n            onClick: () => setOpenRowsWorning(true),\n            startIcon: /*#__PURE__*/_jsxDEV(DeleteIcon, {\n              \"aria-label\": \"delete\",\n              className: classes.iconButton,\n              style: {\n                margin: 0\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this),\n            children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(GridFilterToolbarButton, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridColumnsToolbarButton, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridDensitySelector, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ProductAddDialog, {\n        handleClose: () => setOpenAddDialog(false),\n        handleCreate: handleCreate,\n        open: openAddDialog,\n        namings: namings,\n        locations: locations,\n        employees: employees\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ProductUpdateDialog, {\n        handleClose: () => setOpenUpdateDialog(false),\n        handleUpdate: handleUpdate,\n        open: openUpdateDialog,\n        params: parameters,\n        namings: namings,\n        locations: locations,\n        employees: employees\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(WorningDialog, {\n        openWorning: openWorning,\n        parameters: parameters,\n        handleClose: handleDeleteWorningClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(WorningDialog, {\n        openWorning: openRowsWorning,\n        parameters: {\n          name: \"отмеченные строки\"\n        },\n        handleClose: handleDeleteRowsWorningClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 7\n    }, this);\n  }\n\n  const ref = /*#__PURE__*/React.createRef();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.tableContainer,\n    children: /*#__PURE__*/_jsxDEV(XGrid, {\n      ref: ref,\n      checkboxSelection: true,\n      className: classes.root,\n      localeText: russian,\n      rowHeight: 40,\n      pageSize: 20,\n      headerHeight: 60,\n      columnBuffer: 2,\n      rowsPerPageOptions: [5, 10, 15, 20, 50, 100],\n      pagination: true,\n      density: \"standard\",\n      rows: rows,\n      columns: columns,\n      disableSelectionOnClick: true,\n      showColumnRightBorder: true,\n      showCellRightBorder: true,\n      disableExtendRowFullWidth: true,\n      onSelectionModelChange: params => {\n        setSelection(params.selectionModel);\n      },\n      onColumnHeaderClick: params => {\n        setModel(Object.assign({}, params.api.state));\n      },\n      onRowSelected: params => {\n        setModel(Object.assign({}, params.api.current.state));\n      },\n      components: {\n        Toolbar: CustomToolbar\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 441,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProductTable, \"kjrujo5L3998rw1qJWehScAd4L8=\", false, function () {\n  return [useSnackbar, useStyles];\n});\n\n_c = ProductTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductTable\");","map":{"version":3,"sources":["/home/lilit/workspace/vtk/from_scratch_frontend_vtk/src/components/Product/ProductTable.js"],"names":["React","jsPDF","XGrid","Typography","DeleteIcon","makeStyles","GridToolbarContainer","GridDensitySelector","GridFilterToolbarButton","GridColumnsToolbarButton","IconButton","DeleteForeverOutlinedIcon","EditOutlinedIcon","russian","Tooltip","TextField","MenuItem","ProductAddDialog","ProductUpdateDialog","WorningDialog","Button","useSnackbar","useStyles","toolbarContainer","display","flexDirection","flexGrow","titleLevel","width","paddingLeft","paddingRight","justifyContent","buttonDownload","marginTop","title","flex","tableContainer","height","fontSize","tools","marginBottom","iconButton","backgroundColor","margin","padding","root","border","fontWeight","ProductTable","products","deleteProduct","addProduct","updateProduct","openAddDialog","setOpenAddDialog","useState","openUpdateDialog","setOpenUpdateDialog","parameters","setParameters","namings","setNamings","model","setModel","orientation","setOrientation","deleteDisabled","setDeleteDisabled","selection","setSelection","locations","setLocations","employees","setEmployees","openWorning","setOpenWorning","openRowsWorning","setOpenRowsWorning","enqueueSnackbar","classes","useEffect","setItemsStates","resNamings","fetch","dataNamings","json","namings_","rows","map","naming","Object","assign","name","decimalNumber","resLocations","dataLocations","resEmployees","dataEmployees","employees_","loc","secondName","fatherName","handleAddDialogOpen","handleUpdateDialogOpen","params","_params","row","param","showNotification","text","variant","anchorOrigin","vertical","horizontal","handleCreate","event","product","console","log","namingId","locationId","bookingDate","match","handleUpdate","handleDeleteWorningClose","action","handleDeleteRowsWorningClose","forEach","item","i","id","handleDeleteWorningOpen","exportPDF","length","_columns","entries","columns","lookup","_headers","col","hide","push","header","headerName","dataKey","expRows","keys","idRowsLookup","select","unit","size","_orientation","doc","setFontSize","setFont","setFillColor","content","startY","body","styles","halign","font","lineColor","theme","headStyles","fillColor","textColor","lineWidth","autoTable","window","location","href","save","editColumn","field","sortable","renderCell","deleteColumn","CustomToolbar","marginRight","style","ev","target","value","marginLeft","ref","createRef","selectionModel","api","state","current","Toolbar"],"mappings":"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","sourcesContent":["import * as React from \"react\";\n// import \"./Roboto-Italic-italic.js\";\n// import \"./Roboto-Regular-italic.js\";\nimport \"./FiraSans-Regular-normal.js\";\nimport \"jspdf-autotable\";\nimport jsPDF from \"jspdf\";\nimport { XGrid } from \"@material-ui/x-grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport {\n  GridToolbarContainer,\n  GridDensitySelector,\n  GridFilterToolbarButton,\n  GridColumnsToolbarButton\n} from \"@material-ui/x-grid\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport DeleteForeverOutlinedIcon from \"@material-ui/icons/DeleteForeverOutlined\";\nimport EditOutlinedIcon from \"@material-ui/icons/EditOutlined\";\nimport russian from \"../../constants/localeTextConstants.js\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport TextField from \"@material-ui/core/TextField\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport ProductAddDialog from \"./ProductAddDialog\";\nimport ProductUpdateDialog from \"./ProductUpdateDialog\";\nimport WorningDialog from \"../WorningDialog\";\nimport Button from \"@material-ui/core/Button\";\n\nimport { useSnackbar } from \"notistack\";\n\nconst useStyles = makeStyles({\n  toolbarContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: 0.5\n  },\n  titleLevel: {\n    width: \"100%\",\n    paddingLeft: 20,\n    paddingRight: 20,\n    display: \"flex\",\n    justifyContent: \"center\"\n  },\n  buttonDownload: {\n    marginTop: 20\n  },\n  title: {\n    display: \"flex\",\n    flex: 1,\n    justifyContent: \"center\"\n  },\n  tableContainer: {\n    display: \"flex\",\n    height: \"85vh\",\n    width: \"100%\",\n    justifyContent: \"space-between\",\n    flexGrow: 1,\n    fontSize: \"18px\"\n  },\n  tools: {\n    width: \"100%\",\n    paddingLeft: 20,\n    paddingRight: 20,\n    marginBottom: 30,\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  iconButton: {\n    \"&:hover\": {\n      backgroundColor: \"#bdbdbd\"\n    },\n    margin: 0,\n    padding: 1\n  },\n  root: {\n    \"& .MuiDataGrid-columnsContainer\": {\n      backgroundColor: \"#e8eaf6\",\n      border: \"#bdbdbd solid 1px\"\n    },\n    \"& .MuiDataGrid-colCellTitle\": {\n      fontWeight: \"bold\"\n    }\n  }\n});\n\nexport default function ProductTable({\n  products,\n  deleteProduct,\n  addProduct,\n  updateProduct\n}) {\n  const [openAddDialog, setOpenAddDialog] = React.useState(false);\n  const [openUpdateDialog, setOpenUpdateDialog] = React.useState(false);\n  const [parameters, setParameters] = React.useState({});\n  const [namings, setNamings] = React.useState([]);\n  const [model, setModel] = React.useState({});\n  const [orientation, setOrientation] = React.useState(\"portrait\");\n  const [deleteDisabled, setDeleteDisabled] = React.useState(true);\n  const [selection, setSelection] = React.useState([]);\n  const [locations, setLocations] = React.useState([]);\n  const [employees, setEmployees] = React.useState([]);\n  const [openWorning, setOpenWorning] = React.useState(false);\n  const [openRowsWorning, setOpenRowsWorning] = React.useState(false);\n  const { enqueueSnackbar } = useSnackbar();\n\n  const classes = useStyles();\n\n  React.useEffect(() => {\n    const setItemsStates = async () => {\n      const resNamings = await fetch(\"http://localhost:3001/api/v1/namings\");\n      const dataNamings = await resNamings.json();\n      let namings_ = dataNamings.namings.rows.map(naming => {\n        return Object.assign({}, naming, {\n          name: `${naming.name} ${naming.decimalNumber}`\n        });\n      });\n      setNamings(namings_);\n\n      const resLocations = await fetch(\n        \"http://localhost:3001/api/v1/locations\"\n      );\n      const dataLocations = await resLocations.json();\n      setLocations(dataLocations.locations.rows);\n      const resEmployees = await fetch(\n        \"http://localhost:3001/api/v1/employees\"\n      );\n      const dataEmployees = await resEmployees.json();\n      let employees_ = dataEmployees.employees.rows.map(loc => {\n        return Object.assign({}, loc, {\n          name: `${loc.secondName} ${loc.name[0]}.${loc.fatherName[0]}.`\n        });\n      });\n      setEmployees(employees_);\n    };\n    setItemsStates();\n  }, []);\n\n  const handleAddDialogOpen = async () => {\n    setOpenAddDialog(true);\n  };\n\n  const handleUpdateDialogOpen = async params => {\n    let _params = Object.assign({}, params.row);\n    for (let param in _params) {\n      if (_params[param] === null) _params[param] = \"\";\n    }\n    setParameters(Object.assign({}, _params));\n    setOpenUpdateDialog(true);\n  };\n\n  const showNotification = text => {\n    enqueueSnackbar(text, {\n      variant: \"warning\",\n      anchorOrigin: {\n        vertical: \"top\",\n        horizontal: \"center\"\n      }\n    });\n  };\n\n  const handleCreate = (event, product) => {\n    console.log({ product });\n    if (!product.namingId) showNotification(\"Необходимо выбрать Наименование.\");\n    else if (!product.locationId)\n      showNotification(\"Необходимо выбрать Место производства.\");\n    else if (\n      product.bookingDate &&\n      !product.bookingDate.match(\n        /^(0?[1-9]|[12][0-9]|3[0-1])[/., -](0?[1-9]|1[0-2])[/., -](19|20)?\\d{2}$/\n      )\n    ) {\n      showNotification(\"Неправильный фомат даты бронирования.\");\n    } else {\n      addProduct(product);\n      setOpenAddDialog(false);\n    }\n  };\n\n  const handleUpdate = (event, product) => {\n    if (\n      product.bookingDate &&\n      !product.bookingDate.match(\n        /^(0?[1-9]|[12][0-9]|3[0-1])[/., -](0?[1-9]|1[0-2])[/., -](19|20)?\\d{2}$/\n      )\n    ) {\n      showNotification(\"Неправильный фомат даты бронирования.\");\n    } else {\n      updateProduct(product);\n      setOpenUpdateDialog(false);\n    }\n  };\n\n  const handleDeleteWorningClose = action => {\n    setOpenWorning(false);\n    if (action === \"submit\") deleteProduct(parameters);\n  };\n  const handleDeleteRowsWorningClose = action => {\n    setOpenRowsWorning(false);\n    if (action === \"submit\") {\n      console.log(\"submit\");\n      // deleteProduct(parameters);\n      selection.forEach((item, i) => {\n        console.log({ item });\n        deleteProduct({ id: item });\n      });\n    }\n  };\n\n  const handleDeleteWorningOpen = params => {\n    setOpenWorning(true);\n    setParameters(Object.assign({}, params.row));\n  };\n\n  const exportPDF = () => {\n    // console.log({ selection, model });\n    if (selection.length === 0) {\n      showNotification(\"Необходимо выбрать строки.\");\n      return;\n    }\n    let _columns = Object.entries(model.columns.lookup);\n    let _headers = [];\n    _columns.forEach((col, i) => {\n      if (\n        col[1].hide === false &&\n        col[0] !== \"edit\" &&\n        col[0] !== \"delete\" &&\n        col[0] !== \"__check__\"\n      ) {\n        if (col[0] === \"type\") {\n          _headers.push({\n            header: col[1].headerName,\n            dataKey: \"typeNumber\"\n          });\n        } else if (col[0] === \"location\") {\n          _headers.push({\n            header: col[1].headerName,\n            dataKey: \"locationNumber\"\n          });\n        } else {\n          _headers.push({\n            header: col[1].headerName,\n            dataKey: col[0]\n          });\n        }\n      }\n    });\n    console.log({ _headers });\n    let expRows = [];\n    if (model.rows && Object.keys(model.rows.idRowsLookup).length > 0) {\n      selection.forEach((select, i) => {\n        expRows.push(model.rows.idRowsLookup[select]);\n      });\n    }\n    console.log({ expRows });\n\n    const unit = \"pt\";\n    const size = \"A4\"; // Use A1, A2, A3 or A4\n    const _orientation = orientation; // portrait or landscape\n\n    const doc = new jsPDF(_orientation, unit, size);\n    doc.setFontSize(15);\n    doc.setFont(\"FiraSans-Regular\", \"normal\");\n    const title = \"ВТК - изделия\";\n    doc.setFillColor(0);\n    let content = {\n      startY: 70,\n      columns: _headers,\n      body: expRows,\n      styles: {\n        halign: \"center\",\n        font: \"FiraSans-Regular\",\n        lineColor: \"black\"\n      },\n      theme: \"grid\",\n      headStyles: {\n        halign: \"center\",\n        fillColor: \"#e8eaf6\",\n        textColor: \"black\",\n        lineWidth: 0.5\n      }\n    };\n\n    doc.text(title, 40, 40);\n    doc.autoTable(content);\n    console.log(window.location.href);\n    doc.save(\"report.pdf\");\n  };\n\n  const editColumn = {\n    field: \"edit\",\n    headerName: \"Редактировать\",\n    sortable: false,\n    flex: 0.2,\n    width: 135,\n    renderCell: (params: CellParams) => (\n      <IconButton\n        aria-label=\"edit\"\n        color=\"primary\"\n        className={classes.iconButton}\n        onClick={() => {\n          handleUpdateDialogOpen(params);\n        }}\n      >\n        <EditOutlinedIcon />\n      </IconButton>\n    )\n  };\n\n  const deleteColumn = {\n    field: \"delete\",\n    headerName: \"Удалить\",\n    sortable: false,\n    flex: 0.2,\n    renderCell: (params: CellParams) => (\n      <IconButton\n        aria-label=\"delete\"\n        color=\"secondary\"\n        className={classes.iconButton}\n        onClick={() => handleDeleteWorningOpen(params)}\n      >\n        <DeleteForeverOutlinedIcon />\n      </IconButton>\n    )\n  };\n\n  if (products.columns && products.columns.length > 0) {\n    products.columns.push(editColumn);\n    products.columns.push(deleteColumn);\n  }\n\n  const columns: ColDef[] = products.columns ? products.columns : [];\n  const rows = products.rows ? products.rows : [];\n\n  function CustomToolbar() {\n    return (\n      <GridToolbarContainer className={classes.toolbarContainer}>\n        <div className={classes.titleLevel}>\n          <Typography variant=\"h5\" gutterBottom className={classes.title}>\n            Изделия\n          </Typography>\n          <div className={classes.buttonDownload}>\n            <TextField\n              style={{ width: 110, marginRight: 5 }}\n              InputProps={{ style: { fontSize: 14 } }}\n              id=\"filled-select-currency\"\n              select\n              value={orientation}\n              onChange={ev => {\n                setOrientation(ev.target.value);\n              }}\n              helperText=\"Ориентация\"\n            >\n              <MenuItem key=\"0\" value=\"landscape\" style={{ fontSize: 14 }}>\n                Альбомная\n              </MenuItem>\n              <MenuItem key=\"1\" value=\"portrait\" style={{ fontSize: 14 }}>\n                Книжная\n              </MenuItem>\n            </TextField>\n            <Button\n              color=\"secondary\"\n              variant=\"outlined\"\n              onClick={() => exportPDF()}\n            >\n              {\" \"}\n              скачать\n            </Button>\n          </div>\n        </div>\n\n        <div className={classes.tools}>\n          <div>\n            <Tooltip title=\"Создать новый элемент\">\n              <Button\n                size=\"small\"\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={handleAddDialogOpen}\n              >\n                Создать\n              </Button>\n            </Tooltip>\n            <Button\n              color=\"secondary\"\n              size=\"small\"\n              style={{ marginLeft: 5 }}\n              disabled={selection.length > 0 ? false : true}\n              onClick={() => setOpenRowsWorning(true)}\n              startIcon={\n                <DeleteIcon\n                  aria-label=\"delete\"\n                  className={classes.iconButton}\n                  style={{ margin: 0 }}\n                ></DeleteIcon>\n              }\n            >\n              Удалить\n            </Button>\n          </div>\n          <div>\n            <GridFilterToolbarButton />\n            <GridColumnsToolbarButton />\n            <GridDensitySelector />\n          </div>\n        </div>\n        <ProductAddDialog\n          handleClose={() => setOpenAddDialog(false)}\n          handleCreate={handleCreate}\n          open={openAddDialog}\n          namings={namings}\n          locations={locations}\n          employees={employees}\n        />\n        <ProductUpdateDialog\n          handleClose={() => setOpenUpdateDialog(false)}\n          handleUpdate={handleUpdate}\n          open={openUpdateDialog}\n          params={parameters}\n          namings={namings}\n          locations={locations}\n          employees={employees}\n        />\n        <WorningDialog\n          openWorning={openWorning}\n          parameters={parameters}\n          handleClose={handleDeleteWorningClose}\n        />\n        <WorningDialog\n          openWorning={openRowsWorning}\n          parameters={{ name: \"отмеченные строки\" }}\n          handleClose={handleDeleteRowsWorningClose}\n        />\n      </GridToolbarContainer>\n    );\n  }\n\n  const ref = React.createRef();\n\n  return (\n    <div className={classes.tableContainer}>\n      <XGrid\n        ref={ref}\n        checkboxSelection={true}\n        className={classes.root}\n        localeText={russian}\n        rowHeight={40}\n        pageSize={20}\n        headerHeight={60}\n        columnBuffer={2}\n        rowsPerPageOptions={[5, 10, 15, 20, 50, 100]}\n        pagination\n        density=\"standard\"\n        rows={rows}\n        columns={columns}\n        disableSelectionOnClick={true}\n        showColumnRightBorder={true}\n        showCellRightBorder={true}\n        disableExtendRowFullWidth={true}\n        onSelectionModelChange={params => {\n          setSelection(params.selectionModel);\n        }}\n        onColumnHeaderClick={params => {\n          setModel(Object.assign({}, params.api.state));\n        }}\n        onRowSelected={params => {\n          setModel(Object.assign({}, params.api.current.state));\n        }}\n        components={{\n          Toolbar: CustomToolbar\n        }}\n      />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}